// Badge Program Schema Extension

model BadgeProgram {
  id              String             @id @default(cuid())
  title           String
  description     String
  logoUrl         String?
  autoIssue       Boolean            @default(true)
  isActive        Boolean            @default(true)
  createdAt       DateTime           @default(now())
  updatedAt       DateTime           @updatedAt
  requirements    BadgeRequirement[]
  userBadges      UserBadgeNew[]

  @@map("badge_programs")
}

model BadgeRequirement {
  id       String       @id @default(cuid())
  badgeId  String
  courseId String
  minScore Int          @default(60)
  badge    BadgeProgram @relation(fields: [badgeId], references: [id], onDelete: Cascade)
  course   Course       @relation(fields: [courseId], references: [id], onDelete: Cascade)

  @@unique([badgeId, courseId])
  @@map("badge_requirements")
}

model UserBadgeNew {
  id         String       @id @default(cuid())
  userId     String
  badgeId    String
  earnedAt   DateTime     @default(now())
  verifyCode String       @unique @default(uuid())
  user       User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  badge      BadgeProgram @relation(fields: [badgeId], references: [id], onDelete: Cascade)

  @@unique([userId, badgeId])
  @@map("user_badges_new")
}