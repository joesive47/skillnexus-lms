// Social Features Schema Extension - เพิ่มเติมใน schema.prisma เดิม

model Discussion {
  id        String   @id @default(cuid())
  courseId  String
  userId    String
  title     String
  content   String
  pinned    Boolean  @default(false)
  locked    Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  course    Course   @relation(fields: [courseId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  replies   Reply[]
  likes     DiscussionLike[]
  
  @@index([courseId])
  @@index([createdAt])
}

model Reply {
  id           String   @id @default(cuid())
  discussionId String
  userId       String
  content      String
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  discussion   Discussion @relation(fields: [discussionId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  likes        ReplyLike[]
  
  @@index([discussionId])
}

model DiscussionLike {
  id           String @id @default(cuid())
  discussionId String
  userId       String
  
  discussion   Discussion @relation(fields: [discussionId], references: [id], onDelete: Cascade)
  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([discussionId, userId])
}

model ReplyLike {
  id      String @id @default(cuid())
  replyId String
  userId  String
  
  reply   Reply  @relation(fields: [replyId], references: [id], onDelete: Cascade)
  user    User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([replyId, userId])
}

// Extend User model
model User {
  // ... existing fields ...
  
  // Social relations (เพิ่มเติม)
  discussions     Discussion[]
  replies         Reply[]
  discussionLikes DiscussionLike[]
  replyLikes      ReplyLike[]
}